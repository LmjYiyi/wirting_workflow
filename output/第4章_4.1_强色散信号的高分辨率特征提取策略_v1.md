# 4.1 强色散信号的高分辨率特征提取策略

第三章系统揭示了色散等离子体对LFMCW差频信号的调制机理与适用性边界。研究表明,当判据 $B \cdot \eta \cdot \tau_0 > 1$ 时,色散引入的频率展宽 $\Delta f_D$ 远超FFT频率分辨率 $\delta f = 1/T_m$,频谱主瓣严重散焦,传统峰值检测方法必然失效。这种失效的根本原因在于:强色散条件下,差频信号从单频稳态信号退化为时变调频信号,其频率尺度发生非线性扭曲,导致全频段FFT分析面临无法自洽的逻辑矛盾。具体而言,频域映射关系本身依赖于待反演的色散参数,而参数反演又需要预知频域映射,形成了"已知量与未知量相互依赖"的循环逻辑,使得从模糊且畸变的频谱中直接提取物理参数成为不可能。

为了突破传统方法在强色散区的瓶颈,本文提出了基于滑动窗口的时频特征提取策略。该方法的核心思想是:不再从"全局频谱"反推时间,而是直接控制时间,将复杂的全频段非线性反演问题解耦为一系列局部的线性测量问题。在每个短时观测窗内,介质可近似为局部平稳,色散引入的时变效应被大幅抑制,此时可利用高分辨率频率估计算法(如ESPRIT)精确提取瞬时差频,构建出"频率-时延"特征轨迹,为后续的非线性反演提供可靠的数据基础。

本节将从时频解耦原理、多径抑制与子空间分析三个层面,系统阐述强色散信号的高分辨率特征提取策略。首先分析全频段分析的循环逻辑缺陷与滑动窗口的纠正机制,建立局部信号线性化近似的理论基础。其次,针对实验环境中的多径干扰问题,引入基于MDL准则的信源数估计方法,实现信号子空间与噪声子空间的有效分离。最后,阐述TLS-ESPRIT算法的旋转不变子空间原理,展示如何在短时窗内实现超分辨率的频率估计,完成"频率-时延"特征轨迹的高精度重构。

---

## 4.1.1 基于短时观测窗的时频解耦与局部信号线性化近似

传统LFMCW诊断方法在色散介质中失效的根本原因,不仅在于频谱展宽破坏了峰值检测的信号基础(如3.4.1节分析),更在于其隐含了一个无法打破的循环逻辑——频域分析依赖于色散参数,而色散参数正是待反演的未知量。本节将揭示这一逻辑矛盾的物理本质,并阐明滑动窗口时频解耦策略如何从根本上规避这一困境。

### 全频段分析的参数依赖循环与频率尺度扭曲

回顾3.3.2节推导的差频信号瞬时频率表达式 $f_D(t) = f'_0 + \alpha t$,其中线性调频系数 $\alpha = K(A_1 + KA_2 T_m)$ 包含一阶色散 $A_1 = \mu \tau_1$ 和二阶色散 $A_2$ 的耦合贡献。若试图通过差频频谱 $f$ 反推发射瞬时频率 $f_T$,需建立逆映射关系:

$$f_T = f_0 + \frac{B}{T_m} \left( \frac{f - f'_0}{\alpha} \right) \tag{4-1}$$

然而,该映射关系存在根本性缺陷。在强色散介质(如接近截止频率 $f_p$ 的等离子体)中,调频系数 $\alpha$ 本身是频率的强函数——因为二阶色散系数 $\tau_2(\omega) = \frac{d^2\tau_g}{d\omega^2}$ 随频率剧烈变化,远非泰勒展开假设的常数。这意味着:

**循环逻辑陷阱**。若要通过式(4-1)精确反推 $f_T$,必须预先知道系数 $\alpha$ 的数值,而 $\alpha$ 的计算依赖于待反演的色散参数(等离子体密度 $n_e$ 和碰撞频率 $\nu_e$)。这构成了无法自洽的逻辑死循环——从频谱反推参数,需要参数本身作为先验知识。

**频率尺度的非线性畸变**。由于 $\alpha$ 随频率变化,整个频域的尺度发生了严重的非线性扭曲。具体而言,在截止频率附近,$\tau_2$ 呈奇异发散($\tau_2 \propto [1-(f_p/f)^2]^{-5/2}$),导致频谱被极度压缩或拉伸,频率轴不再是线性的。此时,单一的"中心频率"或"展宽边界"已失去明确的物理对应,直接读取频谱峰值无法唯一映射到真实的物理频率点。

从信号处理的角度看,这种非线性尺度扭曲等价于对差频信号施加了一个频变的"重采样",使得原本均匀的频率网格变为非均匀的"橡皮筋"网格。传统FFT假设的线性频率轴与实际的扭曲频率轴之间的失配,是全频段分析在强色散区不可避免失效的数学根源。

### 滑动窗口的时频解耦原理:以时间定频率

为了打破上述循环,本文采用滑动窗口策略,从根本上改变观测视角——不再从"模糊且扭曲的频谱"反推时间,而是直接控制时间,将未知量从频域映射关系中解耦出来。

**刚性时间基准的引入**。在时刻 $t_i$ 截取滑动窗口,窗口中心对应的发射瞬时频率 $f_{probe}(t_i)$ 是已知且固定的(由发射机硬件严格控制),不受介质色散影响:

$$f_{probe}(t_i) = f_{start} + K \cdot t_i \tag{4-2}$$

该频率的物理意义明确:它是探测信号穿过等离子体时刻的电磁波频率,直接决定了介质对该频率成分的色散响应。关键在于,$f_{probe}$ 是测量过程的**横坐标定义**,而非待求的未知量,从而规避了循环逻辑。

**局部平稳性假设与时变效应抑制**。选择极短的观测窗长 $T_w$(通常为 $T_m$ 的1%~5%),在该时间跨度内,发射频率变化量仅为 $\Delta f = K T_w \ll B$。相应地,群时延的变化量:

$$\Delta \tau_g \approx \left| \frac{d\tau_g}{df} \right| \Delta f = |\tau_1| \cdot \Delta f \tag{4-3}$$

在弱色散近似下,若取 $T_w = 0.02 T_m$,带宽 $B = 3$ GHz,则 $\Delta f = 60$ MHz。即便在强色散区(如 $\eta \approx 0.28$,$\tau_0 = 0.5$ ns),时延变化量 $\Delta \tau_g \approx |\tau_1| \cdot 60 \times 10^6 \approx 10^{-21} \times 6 \times 10^7 \approx 6 \times 10^{-14}$ s,远小于基准时延 $\tau_0$。这意味着在短时窗内,介质可近似为"准静态",群时延 $\tau_g(t) \approx \tau_g(t_i)$ 可视为局部常数。

为了在时间轴上实现高密度采样,滑动窗口以约10%的步长递进,确保相邻窗口之间有90%的重叠。这种高重叠率设计使得时频特征轨迹采样点分布均匀,避免了时域分辨率不足导致的特征点稀疏问题。

**局部信号线性化近似**。在局部平稳假设下,短时窗内的差频信号退化为近似单频正弦波:

$$s_D(t) \approx A_i \cos(2\pi f_{beat,i} t + \phi_i), \quad t \in [t_i - T_w/2, t_i + T_w/2] \tag{4-4}$$

其中差频频率 $f_{beat,i} = K \cdot \tau_g(t_i)$。虽然全局信号呈现非平稳的调频特性,但在每个局部窗口内,调频斜率 $\alpha$ 引入的相位二次项 $\propto t^2$ 被大幅压制:

$$\Delta \phi_{quadratic} \sim \alpha \cdot T_w^2 \ll 2\pi \tag{4-5}$$

以Ka波段参数为例,若 $\alpha \approx 10^{15}$ rad/s²(强色散区量级),$T_w = 10$ μs,则二次相位误差 $\Delta \phi_{quadratic} \approx 10^{15} \times (10^{-5})^2 \approx 0.1$ rad,远小于 $2\pi$。此时信号的频率稳定性满足单频模型假设,可采用高分辨率频谱分析方法(如ESPRIT)精确估计 $f_{beat,i}$。

### 时频特征点集的构建与观测方程建立

通过对整个扫频周期 $T_m$ 进行滑动窗口分割,在每个窗口中心时刻 $t_i$ 提取瞬时差频 $f_{beat,i}$,并计算对应的测量时延:

$$\tau_{meas}(t_i) = \frac{f_{beat,i}}{K} \tag{4-6}$$

由此构建观测特征数据集:

$$\mathcal{D} = \{ (f_{probe,i}, \tau_{meas,i}) \}_{i=1}^{N_w} \tag{4-7}$$

其中 $N_w$ 为滑动窗口总数。该数据集的物理意义清晰:**横坐标 $f_{probe,i}$ 为已知的探测频率(系统刚性控制),纵坐标 $\tau_{meas,i}$ 为测量得到的群时延响应**。两者之间的函数关系直接由Drude模型的色散特性决定,为后续的非线性反演提供观测方程。

关键优势在于,该数据集完全规避了频域映射的循环逻辑——我们不需要预先知道色散参数就能完成特征提取,仅需保证滑动窗口足够短以满足局部平稳性假设。这种"以时间定频率"的策略,将原本病态的全频段反演问题转化为条件良好的局部测量问题,是本文算法鲁棒性的物理基础。

---

## 4.1.2 多径干扰下的信源数估计(MDL准则)与子空间净化

在微波暗室或金属腔体实验环境中,除直达波外,必然存在来自壁面、设备等反射面的多径信号。这些多径分量与直达波在时域上叠加,导致每个滑动窗口内的接收信号实为多个复正弦信号的线性组合。若直接应用单源ESPRIT算法,将错误地将多径分量的频率也纳入估计,引入系统性偏差。因此,必须在频率估计前进行信源数检测与子空间净化。

### 多径干扰的信号模型与子空间结构

假设在第 $i$ 个滑动窗口内,接收到的差频信号包含 $P$ 个路径分量(直达波+多径反射波)。信号模型可表示为:

$$x(n) = \sum_{p=1}^{P} A_p e^{j(2\pi f_p n + \phi_p)} + w(n), \quad n = 1, 2, \ldots, M \tag{4-8}$$

其中 $P$ 为真实信源数(未知量),后文将通过MDL准则估计该路径数,记为 $\hat{P}$。

其中 $f_p$ 为第 $p$ 个路径的归一化差频,$A_p$ 为幅度,$\phi_p$ 为初相,$w(n)$ 为加性高斯白噪声,$M$ 为窗口采样点数。

构造Hankel矩阵并计算前后向平均协方差矩阵 $\mathbf{R}_x$(Forward-Backward Averaging),对其进行特征分解:

$$\mathbf{R}_x = \sum_{i=1}^{L} \lambda_i \mathbf{v}_i \mathbf{v}_i^H \tag{4-9}$$

其中 $\lambda_1 \ge \lambda_2 \ge \cdots \ge \lambda_L$ 为降序排列的特征值,$\mathbf{v}_i$ 为对应的特征向量,$L$ 为子空间维度。根据信号子空间理论,前 $P$ 个大特征值对应信号子空间,后 $(L-P)$ 个小特征值对应噪声子空间:

$$\mathbf{R}_x = \underbrace{\sum_{i=1}^{P} \lambda_i \mathbf{v}_i \mathbf{v}_i^H}_{\text{信号子空间}} + \underbrace{\sum_{i=P+1}^{L} \lambda_i \mathbf{v}_i \mathbf{v}_i^H}_{\text{噪声子空间,} \lambda_i \approx \sigma_w^2} \tag{4-10}$$

### 基于MDL准则的信源数估计

关键问题是:如何从特征值谱自动确定真实信源数 $P$?过估计(将噪声子空间误判为信号)会引入虚假频率,欠估计则会漏检真实路径。本文采用**最小描述长度(Minimum Description Length, MDL)**准则,通过信息论框架在模型复杂度与数据拟合度之间寻找最优平衡。

MDL准则定义目标函数:

$$\text{MDL}(k) = -\ln\left( \frac{\prod_{j=k+1}^{L} \lambda_j^{\frac{1}{L-k}}}{\frac{1}{L-k} \sum_{j=k+1}^{L} \lambda_j} \right)^{(L-k)N_s} + \frac{1}{2} k (2L-k) \ln N_s \tag{4-11}$$

其中 $k$ 为假设的信源数,$N_s$ 为快拍数(对应窗口内的有效样本数),第一项为似然函数的负对数(数据拟合度),第二项为模型复杂度惩罚项。

物理意义解读:式(4-11)的第一项反映了数据拟合度,其核心是几何平均与算术平均之比。分子 $\prod_{j=k+1}^{L} \lambda_j^{\frac{1}{L-k}}$ 为噪声特征值的几何平均,分母 $\frac{1}{L-k} \sum_{j=k+1}^{L} \lambda_j$ 为算术平均。若假设 $k$ 正确,则剩余特征值应为相等的噪声方差 $\sigma_w^2$,此时几何平均等于算术平均,比值接近1,负对数接近0;若 $k$ 过小(欠估计),则信号特征值被错误归入噪声,比值远小于1,第一项剧增。第二项则体现了模型复杂度惩罚:$k$ 个信源对应 $k(2L-k)$ 个待估参数(频率、幅度、相位等),该项随 $k$ 增加而增大,防止模型过拟合。两项的平衡确保了信源数估计在数据拟合与模型简洁性之间达到最优折中。

最优信源数由以下准则确定:

$$\hat{P} = \arg\min_{k=0,1,\ldots,L-1} \text{MDL}(k) \tag{4-12}$$

### 子空间净化与直达波筛选

通过MDL准则确定信源数 $\hat{P}$ 后,提取信号子空间 $\mathbf{U}_s = [\mathbf{v}_1, \mathbf{v}_2, \ldots, \mathbf{v}_{\hat{P}}]$,剔除噪声子空间的干扰,实现子空间净化。为防止MDL在低信噪比下的过估计,实际实现中对信源数施加鲁棒性约束:$\hat{P} = \max(1, \min(k_{MDL}, 3))$,即强制信源数至少为1(保证算法收敛),至多为3(防止将噪声误判为多径)。在此基础上应用ESPRIT算法,可得到 $\hat{P}$ 个频率估计值 $\{f_1, f_2, \ldots, f_{\hat{P}}\}$。

然而,这些频率中包含直达波与多径反射波,需进一步筛选。利用物理先验知识:

**路径长度约束**。反射路径必然长于直达路径,对应的传播时延更大。由差频公式 $f_{beat} = K \cdot \tau$,反射波的差频频率 $f_{beat,reflect} \u003e f_{beat,direct}$。

**幅度衰减特征**。反射波经历多次反射与吸收,幅度显著小于直达波。虽然ESPRIT本身不直接输出幅度信息,但可通过信号子空间投影或特征值大小间接判断。

基于上述准则,采用如下筛选策略:

$$f_{beat,direct} = \min_{j=1,\ldots,\hat{P}} \{ f_j \mid f_j \u003e f_{th} \} \tag{4-13}$$

其中 $f_{th}$ 为低频截止阈值(如50 kHz),用于排除直流泄漏等低频虚假分量。该策略假设直达波对应最小的有效差频,物理上等价于寻找最短传播路径,符合几何光学近似。

通过信源数估计与子空间净化,本文有效抑制了多径干扰对频率估计的影响,为后续的高精度特征提取奠定了基础。在实际实验中,MDL准则能够自动适应不同的多径环境,鲁棒性显著优于固定阈值的经验方法。

---

## 4.1.3 基于TLS-ESPRIT的"频率-时延"特征轨迹高精度重构

在完成信源数估计与子空间净化后,需要从短时窗内的单频(或少数几个分量)信号中精确估计差频频率。传统FFT方法受栅栏效应限制,频率分辨率仅为 $\delta f = 1/T_w$。以 $T_w = 10$ μs 为例,$\delta f = 100$ kHz,而强色散区的差频可能仅为数百kHz,此时FFT无法提供足够的频率精度。本节引入基于旋转不变子空间的TLS-ESPRIT算法,将频率分辨率提升至远超FFT极限的水平,实现"频率-时延"特征轨迹的高精度重构。

### ESPRIT算法的旋转不变子空间原理

ESPRIT(Estimation of Signal Parameters via Rotational Invariance Techniques)算法的核心思想是:利用信号子空间在两个平移阵列间的旋转不变性,将频率估计问题转化为特征值求解问题,从而突破FFT的分辨率限制。

对于式(4-8)的复指数信号模型,定义两个平移一个采样点的子阵列:

$$\mathbf{x}_1 = [x(1), x(2), \ldots, x(L-1)]^T \tag{4-14}$$
$$\mathbf{x}_2 = [x(2), x(3), \ldots, x(L)]^T \tag{4-15}$$

若信号子空间记为 $\mathbf{U}_s = [\mathbf{v}_1, \mathbf{v}_2, \ldots, \mathbf{v}_P]$,则存在旋转矩阵 $\mathbf{\Psi} \in \mathbb{C}^{P \times P}$,使得:

$$\mathbf{U}_{s,2} = \mathbf{U}_{s,1} \mathbf{\Psi} \tag{4-16}$$

其中 $\mathbf{U}_{s,1}$ 和 $\mathbf{U}_{s,2}$ 分别为 $\mathbf{U}_s$ 去掉最后一行和去掉第一行得到的子矩阵。旋转矩阵 $\mathbf{\Psi}$ 的特征值 $z_p = e^{j 2\pi f_p}$ 直接编码了归一化频率 $f_p$:

$$f_p = \frac{\angle z_p}{2\pi} \cdot f_s \tag{4-17}$$

其中 $\angle z_p$ 为 $z_p$ 的相角,$f_s$ 为采样率。关键在于,$\mathbf{\Psi}$ 的求解不依赖于FFT频率网格,而是通过代数特征值分解实现,因此频率估计精度理论上仅受噪声限制,而非采样率限制。

### 总体最小二乘(TLS)增强:对抗有限样本误差

标准ESPRIT算法利用最小二乘(LS)求解旋转矩阵:

$$\mathbf{\Psi}_{LS} = (\mathbf{U}_{s,1}^H \mathbf{U}_{s,1})^{-1} \mathbf{U}_{s,1}^H \mathbf{U}_{s,2} \tag{4-18}$$

然而,该方法存在理论缺陷:它假设 $\mathbf{U}_{s,1}$ 是精确的观测矩阵,所有误差仅存在于 $\mathbf{U}_{s,2}$ 中。实际上,由于有限样本效应,协方差矩阵的特征分解本身就引入了估计误差,导致 $\mathbf{U}_{s,1}$ 和 $\mathbf{U}_{s,2}$ 均为带噪观测。

TLS-ESPRIT算法通过总体最小二乘准则,同时考虑两个子矩阵的误差,求解更鲁棒的旋转矩阵:

$$\min_{\mathbf{\Psi}, \Delta_1, \Delta_2} \| [\Delta_1, \Delta_2] \|_F \quad \text{s.t.} \quad (\mathbf{U}_{s,2} + \Delta_2) = (\mathbf{U}_{s,1} + \Delta_1) \mathbf{\Psi} \tag{4-19}$$

其中 $\| \cdot \|_F$ 为Frobenius范数。该优化问题的解可通过增广矩阵 $[\mathbf{U}_{s,1}, \mathbf{U}_{s,2}]$ 的奇异值分解(SVD)高效求得:

$$[\mathbf{U}_{s,1}, \mathbf{U}_{s,2}] = \mathbf{U} \mathbf{\Sigma} \mathbf{V}^H \tag{4-20}$$

将 $\mathbf{V}$ 分块为 $\mathbf{V} = \begin{bmatrix} \mathbf{V}_{11} & \mathbf{V}_{12} \\ \mathbf{V}_{21} & \mathbf{V}_{22} \end{bmatrix}$,则:

$$\mathbf{\Psi}_{TLS} = -\mathbf{V}_{12} \mathbf{V}_{22}^{-1} \tag{4-21}$$

理论上,TLS-ESPRIT在低信噪比或短数据长度(滑动窗口较短)的场景下,频率估计方差显著降低。然而,在实际工程实现中,当滑动窗口足够长($T_w \ge 10$ μs)且信噪比较高($\text{SNR} \ge 10$ dB)时,LS与TLS的性能差异不大(均方根误差差异小于5%)。考虑到TLS-ESPRIT需要额外的奇异值分解(式4-20),计算复杂度约为LS版本的1.5倍,本文实际采用计算效率更高的LS-ESPRIT实现,同时通过提高窗口重叠率来补偿有限样本误差的影响。在后续第4.3节的仿真验证中,将展示LS-ESPRIT在强色散条件下仍能达到皮秒级时延估计精度的能力。

### "频率-时延"特征轨迹的系统重构

对每个滑动窗口 $i$,通过TLS-ESPRIT算法估计差频频率 $f_{beat,i}$,并根据式(4-6)计算时延 $\tau_{meas,i}$,最终得到完整的特征轨迹:

$$\mathcal{T} = \{ (f_{probe,i}, \tau_{meas,i}) \mid i = 1, 2, \ldots, N_w \} \tag{4-22}$$

该轨迹的物理意义清晰:**在每个探测频率 $f_{probe,i}$ 处,测量得到的群时延为 $\tau_{meas,i}$,构成一条离散的"频率-时延"响应曲线**。根据Drude模型,该曲线在理论上应满足:

$$\tau_{theory}(f; n_e, \nu_e) = \frac{d}{c} \frac{1}{\sqrt{1 - (f_p/f)^2}} + \underbrace{\frac{f}{K} \frac{d\tau_g}{df}}_{一阶色散修正} \tag{4-23}$$

其中 $f_p = \frac{1}{2\pi} \sqrt{\frac{n_e e^2}{\epsilon_0 m_e}}$ 为等离子体截止频率,直接对应待反演的电子密度 $n_e$。通过将测量轨迹 $\mathcal{T}$ 与理论模型式(4-23)进行非线性拟合(第4.2节),即可反演出 $n_e$ 的精确值。

关键优势在于,TLS-ESPRIT提供的频率精度通常可达FFT分辨率的1/10甚至更高。以 $T_w = 10$ μs,FFT分辨率 $\delta f_{FFT} = 100$ kHz 为例,TLS-ESPRIT在10 dB信噪比下可实现约10 kHz的频率估计精度,相当于时延精度提升至数皮秒(ps)量级。这种超分辨能力为后续的等离子体参数反演提供了高质量的观测数据,是本文算法在强色散区仍能保持高精度的核心技术支撑。

通过滑动窗口时频解耦、MDL准则多径抑制与TLS-ESPRIT超分辨估计的三级联合处理,本文成功从强色散的非平稳信号中提取出高精度的"频率-时延"特征轨迹,为下一节的加权非线性反演奠定了坚实的数据基础。
